### Problem 1

x<-c(-1,2,5,9,12)
y<-c(-1,0,4,7,8)

fitt<- lm(y~x)

predict_single<-predict(fitt, data.frame(x=8),level=0.965,interval="prediction")

predict_single

predict_mean<-predict(fitt, data.frame(x=8),level=0.965,interval="confidence")

predict_single

predict_mean
#t.test(y,conf.level = 0.965)


#predict(y, newdata = new.dat, interval = 'confidence',level = 0.965)



# Problem 2 



x=c(175.6, 165.7, 164.6, 171, 180.1, 169.1, 155.3, 174.5, 169.8, 173.9, 178.1, 170.4, 162.3, 183.2, 170.8, 165, 168.6, 172.9, 175.2, 168.9, 168.9, 170, 173.4, 167.9, 178.6, 173.1, 177, 168.4, 168.8, 167.8, 171, 172.9, 161.5, 173.2, 194.3, 171.6, 179.2, 164.9, 168.2, 170.7, 182, 177.3, 173.5, 172.6, 170.8, 167.8, 176.5, 173.3, 166.1, 186, 171.1, 169, 194.2, 174.8, 159, 178, 174.9, 160.6, 170.7, 182.2, 177.1, 168.4, 175.9, 174.5, 161.4, 176.4, 169.6, 178.8, 180.1, 178.9, 176.9, 186.3, 173, 174.3, 175.1, 173.5, 182.4, 170.3, 167.7, 171.4, 178.8, 166.5, 168.1, 176.6, 165.4, 177, 172.3, 169.4, 171.9, 160, 171.9, 176.9, 155, 169.4, 167.6, 164.1, 162.9, 176.2, 167.9, 172.6, 177.8, 169.5, 168.2, 170.8, 169.3, 164.2, 173, 165, 168.6, 175.5, 179.7, 169.6, 166.4, 167.1, 173.9, 171.8, 159.1, 160.5, 177.7, 171.7, 173.5, 179.3, 163.1, 154.3, 174.2, 177.1, 170.9, 169.9, 171.6, 170.7, 167.8, 171.4, 171.6, 175.4, 172.7, 178.8, 174.6, 175.6, 163.5, 171.9, 179.7, 170.6, 174.8, 173.9, 173.9, 173.4, 165.8, 183, 178.1, 180.2, 174.7, 160.7, 183.9, 187.8, 167.9, 164.1, 171.7, 164.7, 182, 173.5, 183.6, 180.2, 164.4, 166.6, 163.2, 164.1, 173.8, 169.3, 164.4, 171.6, 
    180.6, 170, 171, 166.2, 166.2, 166.5, 178.3, 167.8, 183.2, 166.9)

y=c(182.7, 169.3, 172.8, 178, 171.4, 172.2, 164.7, 177.1, 169, 166.2, 172.2, 170.5, 163.6, 188.6, 173.2, 165.3, 176.7, 169.2, 181, 177.5, 173, 177.7, 178.2, 167.9, 174, 173.6, 169, 167.4, 179.9, 171.2, 173, 170.4, 171.5, 176.7, 192.1, 186.8, 166.9, 169.2, 183.8, 163.9, 175.6, 178.2, 162.8, 184.4, 177.8, 172.4, 169.9, 169.3, 176.3, 185.9, 180.2, 183.9, 182.2, 181.7, 172.1, 175.1, 174.3, 159, 169.4, 171.1, 173.8, 181.9, 180.4, 168.3, 163.3, 179.3, 174.3, 171.7, 173.1, 176.9, 175.2, 181.7, 169.6, 179.1, 176.4, 181.3, 190.1, 181.1, 175, 171.6, 174.1, 166.8, 170.6, 174.9, 173.9, 159.2, 177.5, 169, 168.1, 176, 177, 177.5, 162.8, 174, 170, 172.7, 161.5, 183, 167.7, 179.6, 176.1, 183.4, 169.2, 165.5, 165.5, 175.4, 175.8, 165.6, 163.3, 165.2, 186.2, 171.2, 179.8, 180, 167, 166.8, 158.2, 166.9, 174.3, 176, 175.6, 178.7, 167.5, 161.9, 179.4, 179.4, 170.7, 176.6, 169.2, 168.6, 174.4, 178, 168.9, 184.1, 181.2, 178.1, 174.5, 176, 163.6, 169.9, 179.7, 162.4, 177.2, 173.7, 178.8, 170.7, 171, 182.6, 173.2, 171.5, 172.7, 171.8, 178.3, 187.7, 167.9, 171.8, 168.3, 176.5, 192, 173.7, 176.2, 181.8, 164.9, 174.6, 165.5, 165, 173.8, 182.9, 172.5, 172.9, 
    182.9, 182.3, 172, 174.1, 166.9, 171.2, 187, 176.4, 175.7, 172.7)

summary(x)
sd(x)
mean(x)
mean(y)

summary(y)
sd(y)

cor(x,y)

fit<-lm(y~x)

new.dat <- data.frame(x=178)

p <-predict(fit,newdata=new.dat)

t.test(fit)


### Problem 2

x=c(175.6, 165.7, 164.6, 171, 180.1, 169.1, 155.3, 174.5, 169.8, 173.9, 178.1, 170.4, 162.3, 183.2, 170.8, 165, 168.6, 172.9, 175.2, 168.9, 168.9, 170, 173.4, 167.9, 178.6, 173.1, 177, 168.4, 168.8, 167.8, 171, 172.9, 161.5, 173.2, 194.3, 171.6, 179.2, 164.9, 168.2, 170.7, 182, 177.3, 173.5, 172.6, 170.8, 167.8, 176.5, 173.3, 166.1, 186, 171.1, 169, 194.2, 174.8, 159, 178, 174.9, 160.6, 170.7, 182.2, 177.1, 168.4, 175.9, 174.5, 161.4, 176.4, 169.6, 178.8, 180.1, 178.9, 176.9, 186.3, 173, 174.3, 175.1, 173.5, 182.4, 170.3, 167.7, 171.4, 178.8, 166.5, 168.1, 176.6, 165.4, 177, 172.3, 169.4, 171.9, 160, 171.9, 176.9, 155, 169.4, 167.6, 164.1, 162.9, 176.2, 167.9, 172.6, 177.8, 169.5, 168.2, 170.8, 169.3, 164.2, 173, 165, 168.6, 175.5, 179.7, 169.6, 166.4, 167.1, 173.9, 171.8, 159.1, 160.5, 177.7, 171.7, 173.5, 179.3, 163.1, 154.3, 174.2, 177.1, 170.9, 169.9, 171.6, 170.7, 167.8, 171.4, 171.6, 175.4, 172.7, 178.8, 174.6, 175.6, 163.5, 171.9, 179.7, 170.6, 174.8, 173.9, 173.9, 173.4, 165.8, 183, 178.1, 180.2, 174.7, 160.7, 183.9, 187.8, 167.9, 164.1, 171.7, 164.7, 182, 173.5, 183.6, 180.2, 164.4, 166.6, 163.2, 164.1, 
  173.8, 169.3, 164.4, 171.6, 180.6, 170, 171, 166.2, 166.2, 166.5, 178.3, 167.8, 183.2, 166.9)

y=c(182.7, 169.3, 172.8, 178, 171.4, 172.2, 164.7, 177.1, 169, 166.2, 172.2, 170.5, 163.6, 188.6, 173.2, 165.3, 176.7, 169.2, 181, 177.5, 173, 177.7, 178.2, 167.9, 174, 173.6, 169, 167.4, 179.9, 171.2, 173, 170.4, 171.5, 176.7, 192.1, 186.8, 166.9, 169.2, 183.8, 163.9, 175.6, 178.2, 162.8, 184.4, 177.8, 172.4, 169.9, 169.3, 176.3, 185.9, 180.2, 183.9, 182.2, 181.7, 172.1, 175.1, 174.3, 159, 169.4, 171.1, 173.8, 181.9, 180.4, 168.3, 163.3, 179.3, 174.3, 171.7, 173.1, 176.9, 175.2, 181.7, 169.6, 179.1, 176.4, 181.3, 190.1, 181.1, 175, 171.6, 174.1, 166.8, 170.6, 174.9, 173.9, 159.2, 177.5, 169, 168.1, 176, 177, 177.5, 162.8, 174, 170, 172.7, 161.5, 183, 167.7, 179.6, 176.1, 183.4, 169.2, 165.5, 165.5, 175.4, 175.8, 165.6, 163.3, 165.2, 186.2, 171.2, 179.8, 180, 167, 166.8, 158.2, 166.9, 174.3, 176, 175.6, 178.7, 167.5, 161.9, 179.4, 179.4, 170.7, 176.6, 169.2, 168.6, 174.4, 178, 168.9, 184.1, 181.2, 178.1, 174.5, 176, 163.6, 169.9, 179.7, 162.4, 177.2, 173.7, 178.8, 170.7, 171, 182.6, 173.2, 171.5, 172.7, 171.8, 178.3, 187.7, 167.9, 171.8, 168.3, 176.5, 192, 173.7, 176.2, 181.8, 164.9, 174.6, 165.5, 165, 173.8, 182.9, 
  172.5, 172.9, 182.9, 182.3, 172, 174.1, 166.9, 171.2, 187, 176.4, 175.7, 172.7)


## part c 
data<-c(x,y)
data1=as.data.frame(data)
model1 =lm(y~x)
model1
predict1 =predict(model1,data.frame(x=178),interval="prediction",se.fit=TRUE,level=0.95)
predict1

## t value

round(qt(1-(1-0.95)/2,predict1$df),3)




### part d


data=cbind(x,y)
new_data =subset(data,x>=175.5 & x<180.5)
new_data
n=length(new_data[,1])
n

# lower bound interval(CI)
lower_CI  =round(mean(new_data[,2])-2*sd(new_data[,2])/sqrt(n),3)
lower_CI

## Upper bound interval(CI)
upper_CI = round(mean(new_data[,2])+2*sd(new_data[,2])/sqrt(n),3)

upper_CI

# Problem 3




x=c(-0.063114, -0.03538, -0.005977, 0.046451, 0.010618, -0.089884, -0.009908, 0.012117, -0.095181, -0.185636, -0.077798, 0.007791, -0.08955, -0.116457, 0.081953, 0.089772, 0.051721, 0.000196, 0.071522, 0.033009, 0.0351, -0.01996, 0.055779, 0.017615, -0.037675, 0.028115, 0.057133, 0.014651, -0.085532, -0.055388, 0.066516, -0.048612, 0.083928, 0.036193, -0.002293, 0.063257, 0.022393, 0.031457, -0.001048, 
    0.028097, -0.013593, -0.018426, -0.021708, -0.058467, -0.074467, 0.102307, -0.005071, 0.008497)

y=c(-0.231652, -0.039752, -0.145924, 0.00243, 0.023643, -0.02295, -0.136009, 0.080806, -0.111441, -0.019426, -0.147219, 0.143455, -0.062669, -0.165514, 0.117081, -0.098828, 0.129259, 0.027767, 0.070758, 0.077571, -0.013032, -0.022631, 0.157752, 0.01936, 0.043661, -0.034447, 0.02299, -0.063771, -0.039316, 0.048148, -0.014649, 0.020381, 0.056224, -0.013762, -0.051921, 0.055139, -0.083019, -0.018317, 0.024927, 0.085363, 
    0.022041, -0.029711, -0.033271, -0.030647, -0.000342, 0.053617, 0.035673, 0.064812)

fit_4<-lm(y~x)

xnext=c(0.04266, 0.039787, 0.030852, -0.007526, -0.064699, 0.038793, 0.012519, 0.019571, 0.023947, -0.019988)

summary(fit_4)

anova(fit_4)

## t value 
qt(0.975,46)

# finding the lower and upper end point at  x=0.04266

predict_1<-predict(fit_4,data.frame(x=0.04266),level=0.95,interval = "prediction")

predict_1

# finding the lower and upper end point at  x=-0.019988


predict_2<-predict(fit_4,data.frame(x=-0.019988),level=0.95,interval = "prediction")

predict_2



# the last question has 10 as an answer 
# since none of the given x values was used for prediction(my understanding though).

#### Problem 4

game_won_x<-c(81,65,107,100,90,63,91,70)
batting_avg_y<-c(290,290,285,274,271,262,276,265)

cor(game_won_x,batting_avg_y)

cor(batting_avg_y,game_won_x)

lm(formula = batting_avg_y~game_won_x)





### Problem 5 

pr_5_x<-c(-3,0,6)
pr_5_y<-c(1,9,15)

dt<-rbind(pr_5_y,pr_5_x)
dt_2<-t(dt)
df_mtx <- as.data.frame(dt_2)

model <- lm(pr_5_y ~ 7+pr_5_x, data = df_mtx)